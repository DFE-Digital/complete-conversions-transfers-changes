@page "/projects/{projectId}/tasks/confirm_headteacher_contact"
@using Dfe.Complete.Constants
@using Dfe.Complete.Domain.Constants
@using Dfe.Complete.TagHelpers;
@using Dfe.Complete.Utils;
@inject Microsoft.Extensions.Configuration.IConfiguration _configuration

@model Dfe.Complete.Pages.Projects.TaskList.Tasks.ConfirmHeadTeacherDetailsTask.ConfirmHeadTeachersDetailsTaskModel

@{
    Layout = "_ProjectTaskLayout";
    ViewData["Title"] = Model.TaskIdentifier.ToDisplayDescription();
    var projectsExternalContactAddNewLink = string.Format(RouteConstants.NewProjectExternalContacts, Model.ProjectId);
}
@section TaskHeaderHintSection
{
    <div class="govuk-hint">
        @await Html.PartialAsync("~/Pages/Projects/TaskList/_ContactTaskHeaderSection.cshtml")
    </div>
}
@section TaskSection {
    <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">Who is the headteacher?</legend>
    @if (Model?.Contacts != null && Model.Contacts.Count > 0)
    {
        <form method="post" novalidate data-cy="task-update-head-teacher-form">
            <div class="govuk-hint">
                <p>Choose the relevant person from the list of contacts. You may need to add a new contact if the person you are looking for is not in the list.</p>
                <p>Their job title may be slightly different to the role described here. Choose the person whose role most closely matches the headteacher.</p>
            </div>

            <input type="hidden" asp-for="KeyContactId" />            
            @await Html.PartialAsync("_TaskContactRadioList",
            new ContactRadioListModel(Model.Contacts!, Model.HeadTeacherContactId, "HeadTeacherContactId")
            {
                Legend = "Choose a contact"
            }
        )
            @await Html.PartialAsync("_TaskSaveAndReturn", new TaskSaveAndReturnModel(Model.Project, Model.CurrentUserTeam))
        </form>
        }
    else
    {
        <govuk-inset-text>
            No contacts have been added to the project.
        </govuk-inset-text>
        <govuk-button-link asp-policy="@UserPolicyConstants.CanAddContact" href="@projectsExternalContactAddNewLink" data-cy="external-contacts-add-new-button">Add a contact</govuk-button-link>
    }
}