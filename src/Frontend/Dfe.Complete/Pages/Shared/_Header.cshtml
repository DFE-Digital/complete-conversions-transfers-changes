@using Dfe.Complete.Constants
@using Dfe.Complete.Domain.Constants;

@model TabNavigationModel?

@{
    const string currentTabStyling = "govuk-service-navigation__item--active";
    string IsCurrentTab(string tabName) => Model?.CurrentTab == tabName ? currentTabStyling : "";
}

@functions {
    public string GetSearchPlaceholder()
    {
        var query = string.IsNullOrWhiteSpace(Context.Request.Query["query"]) ||
        Context.Request.Query["query"].ToString().Length < 4 ? "Search projects" : Context.Request.Query["query"].ToString();
        return query;
    }
}

<header class="govuk-header" data-module="govuk-header">
    <div class="govuk-header__container govuk-width-container">
        <div class="govuk-header__logo">
        <a href="/" class="govuk-header__link govuk-header__link--homepage">
            <img src="/assets/images/department-for-education_white.png" alt="Department for Education" class="govuk-header__logotype">
        </a>
        </div>
        <div class="govuk-header__search">
            <button id="search-toggle-button" class="govuk-header__search-toggle-button" aria-controls="search-overlay-panel" aria-expanded="false" aria-label="Show search menu" type="button">
                <span class="govuk-visually-hidden">Search projects</span>
                <svg class="govuk-header__search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2"/>
                    <path d="m21 21-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span aria-hidden="true" class="search-close-icon">×</span>
            </button>
        </div>
    </div>
</header>
<div id="search-overlay-panel" class="search-overlay-panel" hidden>
    <div class="govuk-width-container search-overlay-container">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-full">
                <form class="search-overlay-form" asp-page="/Search/SearchProjects" method="get" role="search">
                    <h1 class="govuk-label-wrapper govuk-!-margin-bottom-6">
                        <label class="govuk-label govuk-label--xl" for="search-overlay-input">
                            Search projects
                        </label>
                    </h1>
                    <div class="search-input-wrapper">
                        <input class="govuk-input search-overlay-input" id="search-overlay-input" name="query" type="search" placeholder="Search projects" aria-label="Search projects">
                        <button class="govuk-button search-overlay-button" id="search-submit" type="submit" aria-label="Search">
                            <span class="govuk-visually-hidden">Search projects</span>
                            <svg class="search-overlay-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                                <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2"/>
                                <path d="m21 21-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<section aria-label="Service information" class="govuk-service-navigation"
data-module="govuk-service-navigation">
    <div class="govuk-width-container">
        <div class="govuk-service-navigation__container">
        <span class="govuk-service-navigation__service-name">
            <a href="/" class="govuk-service-navigation__link">
                Complete conversions, transfers and changes
            </a>
        </span>
        <nav aria-label="Menu" class="govuk-service-navigation__wrapper" id="header-navigation" asp-policy="@UserPolicyConstants.HasGlobalNavigation">
            <button type="button" class="govuk-service-navigation__toggle govuk-js-service-navigation-toggle" aria-controls="navigation" hidden>
            Menu
            </button>
            <ul class="govuk-service-navigation__list" id="navigation">
                <li class="govuk-service-navigation__item @IsCurrentTab(TabNavigationModel.YourProjectsTabName)" asp-policy="@UserPolicyConstants.CanViewYourProjects">
                    <a class="govuk-service-navigation__link" href="@RouteConstants.YourProjectsInProgress" aria-current="@(Model?.CurrentTab == TabNavigationModel.YourProjectsTabName ? "true" : "false")">
                        <strong class="govuk-service-navigation__active-fallback">Your projects</strong>
                    </a>
                </li>
                <li class="govuk-service-navigation__item @IsCurrentTab(TabNavigationModel.YourTeamProjectsTabName)" asp-policy="@UserPolicyConstants.CanViewTeamProjects">
                    <a class="govuk-service-navigation__link" href="@RouteConstants.TeamProjectsInProgress">
                        Your team projects
                    </a>
                </li>
                <li class="govuk-service-navigation__item @IsCurrentTab(TabNavigationModel.AllProjectsTabName)">
                    <a class="govuk-service-navigation__link" href="@RouteConstants.ProjectsInProgress">
                        All projects
                    </a>
                </li>
                <li class="govuk-service-navigation__item @IsCurrentTab(TabNavigationModel.GroupsTabName)" asp-policy="@UserPolicyConstants.CanViewGroups">
                    <a class="govuk-service-navigation__link" href="@RouteConstants.Groups">
                        Groups
                    </a>
                </li>
                <li class="govuk-service-navigation__item @IsCurrentTab(TabNavigationModel.ServiceSupportProjectsTabName)" asp-policy="@UserPolicyConstants.CanViewServiceSupport">
                    <a class="govuk-service-navigation__link" href="@RouteConstants.ServiceSupportProjectsWithoutAcademyUrn">
                        Service support
                    </a>
                </li>
            </ul>
        </nav>
        </div>
    </div>
</section>